- name: Deploy application
  run: |
    # Stop existing Node.js server
    pkill -f "node src/server.js" || true

    # Start app in background
    nohup node src/server.js > deploy.log 2>&1 &

    # Wait for app to start
    sleep 10

    echo "=== Deploy log output ==="
    cat deploy.log

    # Check if app started successfully
    if pgrep -f "node src/server.js" > /dev/null; then
      echo "✅ Application deployed successfully"
    else
      echo "❌ Deployment failed"
      ps aux | grep node
      exit 1
    fi
